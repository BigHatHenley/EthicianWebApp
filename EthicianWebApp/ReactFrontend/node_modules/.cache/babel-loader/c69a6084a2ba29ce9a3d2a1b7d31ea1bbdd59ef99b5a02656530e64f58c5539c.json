{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Hat\\\\Documents\\\\Work Stuff\\\\EthicianWebApp\\\\ReactFrontend\\\\src\\\\components\\\\MultiChatXpertPage.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport './MultiChatXpertPage.css';\nimport userImage from './images/personTyping.gif';\nimport aiImage from './images/AILooking.gif';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction MultiChatXpertPage() {\n  _s();\n  const [messages, setMessages] = useState([]);\n  const [isTTSEnabled, setTTSEnabled] = useState(false);\n  const [isSpeechRecognitionOpen, setSpeechRecognitionOpen] = useState(false);\n  const [isLLMSelectionOpen, setLLMSelectionOpen] = useState(false);\n  const [isUpdateExpertsOpen, setUpdateExpertsOpen] = useState(false);\n  const [isExpertPopupOpen, setExpertPopupOpen] = useState(false);\n  const [experts, setExperts] = useState([\"Ethician\", \"Mechanical Engineer\", \"Metallurgist\", \"Safety Engineer\", \"Materials Engineer\", \"Robotics Engineer\", \"Electrical Engineer\", \"Civil Engineer\", \"Software Engineer\", \"Chemical Engineer\", \"Aerospace Engineer\", \"Petroleum Engineer\", \"Biomedical Engineer\", \"Environment Engineer\", \"Quality Engineer\"]);\n  const [selectedExperts, setSelectedExperts] = useState([]);\n  const [currentLLM, setCurrentLLM] = useState(null);\n  const [showEditPopup, setShowEditPopup] = useState(false); // Track if edit popup is open\n  const [currentExpertEdit, setCurrentExpertEdit] = useState(null); // Track current expert to edit\n  const [newExpertName, setNewExpertName] = useState(\"\"); // Track new expert name input\n\n  // const [expertToggles, setExpertToggles] = useState(Array(15).fill(false));\n  const [prompt, setPrompt] = useState(\"\");\n  const [isListening, setIsListening] = useState(false);\n  const [volume, setVolume] = useState(50); // Volume state\n\n  // Check if the browser supports speech recognition\n  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\n  const recognition = SpeechRecognition ? new SpeechRecognition() : null;\n  // const [transcript, setTranscript] = useState(\"\");\n  // const [error, setError] = useState(null);\n\n  const [conversationHistory, setConversationHistory] = useState([]);\n  const [isLoggedIn, setIsLoggedIn] = useState(false); // Assume initially logged out\n\n  const [attachedFiles, setAttachedFiles] = useState([]); // <-- Define attachedFiles here\n\n  useEffect(() => {\n    const fetchConversations = async () => {\n      try {\n        const csrfToken = getCsrfToken(); // Retrieve CSRF token function\n        const response = await axios.get('https://199c-2601-702-0-9480-988c-b43-9c08-63d1.ngrok-free.app/api/get_conversations/', {\n          withCredentials: true,\n          headers: {\n            'X-CSRFToken': csrfToken\n          }\n        });\n        setConversationHistory(response.data);\n        setIsLoggedIn(true);\n      } catch (error) {\n        console.error('Error fetching conversation history:', error);\n        setIsLoggedIn(false);\n      }\n    };\n    fetchConversations();\n  }, []);\n  if (recognition) {\n    recognition.continuous = false;\n    recognition.interimResults = false;\n    recognition.lang = 'en-US';\n    recognition.onresult = event => {\n      const transcript = event.results[0][0].transcript;\n      setPrompt(transcript); // Update the entry bar with the transcribed text\n      console.log(\"Transcribed Text:\", transcript); // Log transcription to browser console\n    };\n    recognition.onerror = event => {\n      console.error(\"Speech recognition error:\", event.error); // Error handling in console\n      setIsListening(false); // Reset listening state\n    };\n    recognition.onend = () => {\n      console.log(\"Speech recognition ended.\"); // Log end of recognition to browser console\n      setIsListening(false); // Ensure the recording state is reset\n    };\n  }\n\n  // Start listening for speech\n  const handleStartListening = () => {\n    if (recognition && !isListening) {\n      setPrompt(\"\"); // Clear any previous text in entry bar\n      setIsListening(true);\n      console.log(\"Starting Speech Recognition\"); // Log to browser console\n      recognition.start();\n    }\n  };\n\n  // Stop listening for speech\n  const handleStopListening = () => {\n    if (recognition && isListening) {\n      console.log(\"Stopping Speech Recognition\"); // Log to browser console\n      recognition.stop();\n      setIsListening(false); // Reset state so user can restart recording\n    }\n  };\n\n  // const handlePromptSubmit = () => {\n  //   const newMessage = { text: prompt, isUser: true };\n  //   setMessages([...messages, newMessage]);\n  //   handleSendMessage(prompt);\n  //   setPrompt(\"\");\n  // };\n\n  // const openPopup = (setting) => {\n  //   setTTSEnabled(false);\n  //   setSpeechRecognitionOpen(false);\n  //   setLLMSelectionOpen(false);\n  //   setUpdateExpertsOpen(false);\n\n  //   if (setting === \"TTS\") setTTSEnabled(true);\n  //   if (setting === \"SpeechRecognition\") setSpeechRecognitionOpen(true);\n  //   if (setting === \"LLMSelection\") setLLMSelectionOpen(true);\n  //   if (setting === \"UpdateExperts\") setUpdateExpertsOpen(true);\n  // };\n\n  // Function to toggle TTS setting\n  const toggleTTS = () => {\n    setTTSEnabled(!isTTSEnabled);\n    console.log(\"TTS Enabled:\", !isTTSEnabled); // Log for confirmation\n  };\n  const toggleExpertPopup = () => {\n    setExpertPopupOpen(!isExpertPopupOpen);\n  };\n\n  // const updateExpertName = (index, newName) => {\n  //   const updatedExperts = [...experts];\n  //   updatedExperts[index] = newName;\n  //   setExperts(updatedExperts);\n  // };\n\n  // Function to handle expert selection in the AI Image popup\n  const handleExpertSelection = expert => {\n    setSelectedExperts(prevExperts => {\n      const updatedExperts = prevExperts.includes(expert) ? prevExperts.filter(e => e !== expert) : [...prevExperts, expert];\n      console.log(\"Updated selectedExperts:\", updatedExperts); // Log after update\n      return updatedExperts;\n    });\n  };\n  const handleLLMSelection = llm => {\n    setCurrentLLM(llm);\n    console.log(\"Updated currentLLM:\", llm); // Log after update\n  };\n  const handleEditExpertClick = index => {\n    setCurrentExpertEdit(index);\n    setNewExpertName(experts[index]);\n    setShowEditPopup(true);\n  };\n  const handleSaveExpertName = () => {\n    const updatedExperts = [...experts];\n    updatedExperts[currentExpertEdit] = newExpertName;\n    setExperts(updatedExperts);\n    setShowEditPopup(false);\n  };\n  function getCsrfToken() {\n    const name = 'csrftoken';\n    const cookies = document.cookie.split(';');\n    for (let cookie of cookies) {\n      cookie = cookie.trim();\n      if (cookie.startsWith(name + '=')) {\n        return cookie.substring(name.length + 1);\n      }\n    }\n    return null;\n  }\n  const handleRestoreConversation = conversationText => {\n    // Assuming conversationText is newline-delimited for each message\n    const restoredMessages = conversationText.split('\\n').map((text, idx) => ({\n      text,\n      isUser: idx % 2 === 0 // Toggle between user and AI messages for simplicity\n    }));\n    setMessages(restoredMessages);\n  };\n  const handleSendMessage = async message => {\n    const formData = new FormData();\n    formData.append(\"text\", message);\n    formData.append(\"selected_experts\", JSON.stringify(selectedExperts));\n    formData.append(\"selected_option\", currentLLM);\n\n    // Attach files if there are any\n    if (attachedFiles.length > 0) {\n      attachedFiles.forEach(file => {\n        formData.append('file', file);\n      });\n    }\n    try {\n      console.log(\"Sending message to backend\");\n      const response = await axios.post('https://199c-2601-702-0-9480-988c-b43-9c08-63d1.ngrok-free.app/api/analyze_text/', formData, {\n        headers: {\n          'X-CSRFToken': getCsrfToken()\n        },\n        withCredentials: true\n      });\n      console.log(\"Full response data:\", response.data);\n\n      // Check if response is an object with only text or includes images\n      if (typeof response.data === 'object' && response.data !== null) {\n        const {\n          text,\n          images\n        } = response.data;\n\n        // If `images` is not present or is an empty array, treat as text-only\n        if (text && (!images || images.length === 0)) {\n          console.log(\"No Images detected, treating as text\");\n          setMessages(prevMessages => [...prevMessages, {\n            text: text,\n            isUser: false\n          }]);\n          if (isTTSEnabled) speakText(text, volume / 100);\n        }\n        // If images are present, handle both text and images\n        else {\n          console.log(\"Image detected\");\n          if (text) {\n            console.log(\"The text with image is: \", text);\n            setMessages(prevMessages => [...prevMessages, {\n              text: text,\n              isUser: false\n            }]);\n            if (isTTSEnabled) speakText(text, volume / 100);\n          }\n          if (Array.isArray(images) && images.length > 0) {\n            images.forEach(imgUrl => {\n              setMessages(prevMessages => [...prevMessages, {\n                images: [{\n                  url: imgUrl\n                }],\n                isUser: false\n              }]);\n            });\n          }\n        }\n      } else if (typeof response.data === 'string') {\n        console.log(\"String Only\");\n        // Treat response as simple text if it's a string\n        setMessages(prevMessages => [...prevMessages, {\n          text: response.data,\n          isUser: false\n        }]);\n        if (isTTSEnabled) speakText(response.data, volume / 100);\n      } else {\n        console.warn(\"Unexpected response format received:\", response.data);\n      }\n\n      // Save conversation if the user is logged in\n      if (isLoggedIn) {\n        const fullConversation = messages.map(msg => {\n          var _msg$images;\n          return msg.text || ((_msg$images = msg.images) === null || _msg$images === void 0 ? void 0 : _msg$images[0].url) || \"\";\n        }).join('\\n');\n        await axios.post('https://199c-2601-702-0-9480-988c-b43-9c08-63d1.ngrok-free.app/api/save_conversation/', {\n          conversation_text: fullConversation\n        }, {\n          headers: {\n            'X-CSRFToken': getCsrfToken()\n          },\n          withCredentials: true\n        });\n      }\n    } catch (error) {\n      console.error('Error sending message to backend:', error);\n    }\n  };\n\n  // Ensure `speakText` uses the specified volume\n  const speakText = (text, volumeLevel = 0.5) => {\n    if ('speechSynthesis' in window) {\n      const utterance = new SpeechSynthesisUtterance(text);\n      utterance.volume = volumeLevel; // Volume adjusted here\n      window.speechSynthesis.speak(utterance);\n    } else {\n      console.warn(\"TTS not supported in this browser\");\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"my-ui-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"ai-container\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"ai-image\",\n        onClick: toggleExpertPopup,\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: aiImage,\n          alt: \"AI Expert\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 298,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 297,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 7\n    }, this), isExpertPopupOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"expert-popup\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Available Experts\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 305,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"expert-grid\",\n        children: experts.map((expert, index) => /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => handleExpertSelection(expert),\n          className: `expert-button ${selectedExperts.includes(expert) ? 'selected' : ''}`,\n          children: expert\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: toggleExpertPopup,\n        className: \"close-popup-button\",\n        children: \"Close\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 317,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 304,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"console-container\",\n      children: /*#__PURE__*/_jsxDEV(Console, {\n        experts: experts,\n        conversationHistory: conversationHistory,\n        handleRestoreConversation: handleRestoreConversation,\n        handleEditExpertClick: handleEditExpertClick,\n        volume: volume,\n        setVolume: setVolume,\n        handleStartListening: handleStartListening,\n        handleStopListening: handleStopListening,\n        isListening: isListening // Control the button label and behavior\n        ,\n        handleLLMSelection: handleLLMSelection // Pass handleLLMSelection to Console\n        ,\n        currentLLM: currentLLM,\n        toggleTTS: toggleTTS,\n        isTTSEnabled: isTTSEnabled\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 322,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 321,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"user-container\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"user-image\",\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: userImage,\n          alt: \"User Icon\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 341,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 340,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 339,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"conversation-container\",\n      children: /*#__PURE__*/_jsxDEV(ConversationWindow, {\n        messages: messages\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 346,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 345,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"entry-box-container\",\n      children: /*#__PURE__*/_jsxDEV(InputSection, {\n        attachedFiles: attachedFiles,\n        setAttachedFiles: setAttachedFiles,\n        prompt: prompt // Pass the transcribed prompt\n        ,\n        setPrompt: setPrompt,\n        onPromptSubmit: prompt => {\n          const newMessage = {\n            text: prompt,\n            isUser: true\n          };\n          setMessages([...messages, newMessage]);\n          handleSendMessage(prompt);\n        },\n        onFileUpload: file => console.log('File uploaded:', file.name),\n        onCopyConversation: () => navigator.clipboard.writeText(messages.map(m => m.text).join('\\n'))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 350,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 349,\n      columnNumber: 7\n    }, this), showEditPopup && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"overlay\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"edit-popup\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"Edit Expert\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 369,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          value: newExpertName,\n          onChange: e => setNewExpertName(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 370,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleSaveExpertName,\n          children: \"Save\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 375,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setShowEditPopup(false),\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 376,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 368,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 367,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 295,\n    columnNumber: 5\n  }, this);\n}\n\n// Console Component\n_s(MultiChatXpertPage, \"IbJcVbF0f6PJRdCaE7ti+s/vs/Y=\");\n_c = MultiChatXpertPage;\nfunction Console({\n  experts,\n  handleEditExpertClick,\n  conversationHistory,\n  handleRestoreConversation,\n  volume,\n  setVolume,\n  handleStartListening,\n  handleStopListening,\n  isListening,\n  handleLLMSelection,\n  currentLLM,\n  toggleTTS,\n  isTTSEnabled\n}) {\n  _s2();\n  const [currentView, setCurrentView] = useState(\"default\");\n  const options = [\"Text-To-Speech\", \"Speech Recognition\", \"LLM Selection\", \"Update Experts\", \"Conversation Select\"];\n  const [currentOptionIndex, setCurrentOptionIndex] = useState(0);\n  const handleSelectOption = () => {\n    setCurrentView(options[currentOptionIndex]);\n  };\n  const handleBack = () => {\n    setCurrentView(\"default\");\n  };\n  const handleScroll = direction => {\n    if (direction === 'up') {\n      setCurrentOptionIndex(prev => prev === 0 ? options.length - 1 : prev - 1);\n    } else {\n      setCurrentOptionIndex(prev => prev === options.length - 1 ? 0 : prev + 1);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"console-container\",\n    children: currentView === \"default\" ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"settings-grid\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"settings-display\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"console-option\",\n          children: options[currentOptionIndex]\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 425,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 424,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"settings-buttons\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => handleScroll('up'),\n          className: \"up-arrow\",\n          children: \"\\u25B2\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 430,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleSelectOption,\n          className: \"select-button\",\n          children: \"Select\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 431,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => handleScroll('down'),\n          className: \"down-arrow\",\n          children: \"\\u25BC\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 432,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 429,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"volume-slider-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"volume-label\",\n          children: \"Volume Level:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 436,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"range\",\n          className: \"volume-slider\",\n          min: \"0\",\n          max: \"100\",\n          value: volume,\n          onChange: e => setVolume(Number(e.target.value))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 437,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"volume-level\",\n          children: volume\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 445,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 435,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 423,\n      columnNumber: 5\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"settings-content\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: currentView\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 450,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"settings-page-content\",\n        children: [currentView === \"Text-To-Speech\" && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Enable or disable Text-to-Speech:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 454,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: toggleTTS,\n            className: `tts-button ${isTTSEnabled ? 'tts-enabled' : 'tts-disabled'}`,\n            children: isTTSEnabled ? \"Disable TTS\" : \"Enable TTS\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 455,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"volume-slider-container\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"volume-label\",\n              children: \"TTS Volume:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 460,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"range\",\n              className: \"volume-slider\",\n              min: \"0\",\n              max: \"100\",\n              value: volume,\n              onChange: e => setVolume(Number(e.target.value))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 461,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"volume-level\",\n              children: [\" \", volume]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 469,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 459,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true), currentView === \"Speech Recognition\" && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Control Speech Recognition:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 475,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: isListening ? handleStopListening : handleStartListening,\n            children: isListening ? \"Stop Recording\" : \"Start Recording\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 476,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true), currentView === \"LLM Selection\" && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Select Language Model:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 483,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            className: \"llm-dropdown\",\n            value: currentLLM || \"\",\n            onChange: e => handleLLMSelection(e.target.value),\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              disabled: true,\n              children: \"Select an LLM\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 489,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"ChatGPT\",\n              children: \"ChatGPT\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 490,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"Google Gemini\",\n              children: \"Google Gemini\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 491,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"Anthropic Claude\",\n              children: \"Anthropic Claude\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 492,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 484,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true), currentView === \"Update Experts\" && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"expert-grid\",\n          children: experts.map((expert, index) => /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"expert-button\",\n            onClick: () => handleEditExpertClick(index),\n            children: expert\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 499,\n            columnNumber: 19\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 497,\n          columnNumber: 15\n        }, this), currentView === \"Conversation Select\" && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Select a conversation to review:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 507,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"conversation-history\",\n            children: conversationHistory.length > 0 ? conversationHistory.map((conv, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"conversation-item\",\n              onClick: () => handleRestoreConversation(conv.conversation_text),\n              children: `${conv.user_id}'s Conversation ${new Date(conv.timestamp).toLocaleString()}`\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 511,\n              columnNumber: 23\n            }, this)) : /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"No conversation history available.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 520,\n              columnNumber: 21\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 508,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 451,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleBack,\n        className: \"back-button\",\n        children: \"Back\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 526,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 449,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 421,\n    columnNumber: 5\n  }, this);\n}\n\n// ConversationWindow Component\n_s2(Console, \"EDZiq2nsR6IzKF+HOEuRUdC3Kmg=\");\n_c2 = Console;\nfunction ConversationWindow({\n  messages\n}) {\n  _s3();\n  const conversationRef = useRef(null);\n  useEffect(() => {\n    if (conversationRef.current) {\n      console.log(\"Updated messages:\", messages);\n      conversationRef.current.scrollTop = conversationRef.current.scrollHeight;\n    }\n  }, [messages]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"conversation-window\",\n    ref: conversationRef,\n    children: messages.map((message, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `message-bubble ${message.isUser ? 'user-message' : 'ai-message'}`,\n      children: [message.text && /*#__PURE__*/_jsxDEV(\"p\", {\n        children: message.text\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 552,\n        columnNumber: 34\n      }, this), message.images && message.images.length > 0 && message.images.map((img, imgIndex) => /*#__PURE__*/_jsxDEV(\"img\", {\n        src: img.url,\n        alt: \"AI response\",\n        className: \"ai-image-response\",\n        style: {\n          maxWidth: '100%',\n          marginTop: '10px',\n          borderRadius: '8px'\n        }\n      }, imgIndex, false, {\n        fileName: _jsxFileName,\n        lineNumber: 556,\n        columnNumber: 21\n      }, this))]\n    }, index, true, {\n      fileName: _jsxFileName,\n      lineNumber: 547,\n      columnNumber: 13\n    }, this))\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 545,\n    columnNumber: 5\n  }, this);\n}\n\n// TTS function\n// function speakText(text) {\n//   if ('speechSynthesis' in window) {\n//     const utterance = new SpeechSynthesisUtterance(text);\n//     utterance.rate = 1; // You can adjust rate, pitch, and volume here if needed\n//     window.speechSynthesis.speak(utterance);\n//   } else {\n//     console.warn(\"TTS not supported in this browser\");\n//   }\n// }\n\n// InputSection Component\n_s3(ConversationWindow, \"Y7nFwtZO/hlnq7te7GKq0r5Z7DM=\");\n_c3 = ConversationWindow;\nfunction InputSection({\n  prompt,\n  setPrompt,\n  onPromptSubmit,\n  onFileUpload,\n  onCopyConversation,\n  attachedFiles,\n  setAttachedFiles\n}) {\n  const handleInputChange = e => {\n    setPrompt(e.target.value);\n    e.target.style.height = \"auto\";\n    e.target.style.height = `${e.target.scrollHeight}px`;\n  };\n  const handleFileUpload = e => {\n    const files = Array.from(e.target.files);\n    if (attachedFiles.length + files.length > 5) {\n      alert(\"You can only attach up to 5 files at a time.\");\n      return;\n    }\n    const newFiles = files.map(file => {\n      if (file.type.startsWith(\"image/\")) {\n        const reader = new FileReader();\n        reader.onload = e => {\n          file.preview = e.target.result; // Add preview data to the file object\n          setAttachedFiles(prev => [...prev]); // Trigger a re-render\n        };\n        reader.readAsDataURL(file);\n      }\n      return file;\n    });\n    setAttachedFiles(prev => [...prev, ...newFiles]);\n    files.forEach(file => onFileUpload(file));\n  };\n  const handleRemoveFile = index => {\n    const updatedFiles = attachedFiles.filter((_, i) => i !== index);\n    setAttachedFiles(updatedFiles);\n  };\n  const handleBlur = e => {\n    if (prompt === \"\") {\n      e.target.style.height = \"20px\";\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"input-section\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"attached-files-container\",\n      children: attachedFiles.map((file, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"attached-file-popup\",\n        children: [file.preview ? /*#__PURE__*/_jsxDEV(\"img\", {\n          src: file.preview,\n          alt: file.name,\n          className: \"attached-file-image\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 632,\n          columnNumber: 15\n        }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n          children: file.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 634,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => handleRemoveFile(index),\n          className: \"remove-file-button\",\n          children: \"\\u2715\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 636,\n          columnNumber: 13\n        }, this)]\n      }, index, true, {\n        fileName: _jsxFileName,\n        lineNumber: 630,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 628,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n      value: prompt,\n      onChange: e => setPrompt(e.target.value),\n      onBlur: handleBlur,\n      className: \"prompt-input\",\n      placeholder: \"Type your message here...\",\n      rows: 1,\n      style: {\n        height: \"20px\"\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 641,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => onPromptSubmit(prompt),\n      children: \"Submit\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 650,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: onCopyConversation,\n      children: \"Copy Conversation\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 651,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => document.getElementById('file-upload').click(),\n      children: \"Upload File\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 652,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"file\",\n      id: \"file-upload\",\n      style: {\n        display: 'none'\n      },\n      onChange: handleFileUpload\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 653,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 626,\n    columnNumber: 5\n  }, this);\n}\n_c4 = InputSection;\nexport default MultiChatXpertPage;\nvar _c, _c2, _c3, _c4;\n$RefreshReg$(_c, \"MultiChatXpertPage\");\n$RefreshReg$(_c2, \"Console\");\n$RefreshReg$(_c3, \"ConversationWindow\");\n$RefreshReg$(_c4, \"InputSection\");","map":{"version":3,"names":["React","useState","useEffect","useRef","userImage","aiImage","axios","jsxDEV","_jsxDEV","Fragment","_Fragment","MultiChatXpertPage","_s","messages","setMessages","isTTSEnabled","setTTSEnabled","isSpeechRecognitionOpen","setSpeechRecognitionOpen","isLLMSelectionOpen","setLLMSelectionOpen","isUpdateExpertsOpen","setUpdateExpertsOpen","isExpertPopupOpen","setExpertPopupOpen","experts","setExperts","selectedExperts","setSelectedExperts","currentLLM","setCurrentLLM","showEditPopup","setShowEditPopup","currentExpertEdit","setCurrentExpertEdit","newExpertName","setNewExpertName","prompt","setPrompt","isListening","setIsListening","volume","setVolume","SpeechRecognition","window","webkitSpeechRecognition","recognition","conversationHistory","setConversationHistory","isLoggedIn","setIsLoggedIn","attachedFiles","setAttachedFiles","fetchConversations","csrfToken","getCsrfToken","response","get","withCredentials","headers","data","error","console","continuous","interimResults","lang","onresult","event","transcript","results","log","onerror","onend","handleStartListening","start","handleStopListening","stop","toggleTTS","toggleExpertPopup","handleExpertSelection","expert","prevExperts","updatedExperts","includes","filter","e","handleLLMSelection","llm","handleEditExpertClick","index","handleSaveExpertName","name","cookies","document","cookie","split","trim","startsWith","substring","length","handleRestoreConversation","conversationText","restoredMessages","map","text","idx","isUser","handleSendMessage","message","formData","FormData","append","JSON","stringify","forEach","file","post","images","prevMessages","speakText","Array","isArray","imgUrl","url","warn","fullConversation","msg","_msg$images","join","conversation_text","volumeLevel","utterance","SpeechSynthesisUtterance","speechSynthesis","speak","className","children","onClick","src","alt","fileName","_jsxFileName","lineNumber","columnNumber","Console","ConversationWindow","InputSection","onPromptSubmit","newMessage","onFileUpload","onCopyConversation","navigator","clipboard","writeText","m","type","value","onChange","target","_c","_s2","currentView","setCurrentView","options","currentOptionIndex","setCurrentOptionIndex","handleSelectOption","handleBack","handleScroll","direction","prev","min","max","Number","disabled","conv","user_id","Date","timestamp","toLocaleString","_c2","_s3","conversationRef","current","scrollTop","scrollHeight","ref","img","imgIndex","style","maxWidth","marginTop","borderRadius","_c3","handleInputChange","height","handleFileUpload","files","from","alert","newFiles","reader","FileReader","onload","preview","result","readAsDataURL","handleRemoveFile","updatedFiles","_","i","handleBlur","onBlur","placeholder","rows","getElementById","click","id","display","_c4","$RefreshReg$"],"sources":["C:/Users/Hat/Documents/Work Stuff/EthicianWebApp/ReactFrontend/src/components/MultiChatXpertPage.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport './MultiChatXpertPage.css';\r\nimport userImage from './images/personTyping.gif';\r\nimport aiImage from './images/AILooking.gif';\r\nimport axios from 'axios';\r\n\r\nfunction MultiChatXpertPage() {\r\n  const [messages, setMessages] = useState([]);\r\n  const [isTTSEnabled, setTTSEnabled] = useState(false);\r\n  const [isSpeechRecognitionOpen, setSpeechRecognitionOpen] = useState(false);\r\n  const [isLLMSelectionOpen, setLLMSelectionOpen] = useState(false);\r\n  const [isUpdateExpertsOpen, setUpdateExpertsOpen] = useState(false);\r\n  const [isExpertPopupOpen, setExpertPopupOpen] = useState(false);\r\n  const [experts, setExperts] = useState([\r\n    \"Ethician\", \"Mechanical Engineer\", \"Metallurgist\", \"Safety Engineer\", \"Materials Engineer\",\r\n    \"Robotics Engineer\", \"Electrical Engineer\", \"Civil Engineer\", \"Software Engineer\", \"Chemical Engineer\",\r\n    \"Aerospace Engineer\", \"Petroleum Engineer\", \"Biomedical Engineer\", \"Environment Engineer\", \"Quality Engineer\"\r\n  ]);\r\n  const [selectedExperts, setSelectedExperts] = useState([]);\r\n  const [currentLLM, setCurrentLLM] = useState(null);\r\n  const [showEditPopup, setShowEditPopup] = useState(false); // Track if edit popup is open\r\n  const [currentExpertEdit, setCurrentExpertEdit] = useState(null); // Track current expert to edit\r\n  const [newExpertName, setNewExpertName] = useState(\"\"); // Track new expert name input\r\n  \r\n  // const [expertToggles, setExpertToggles] = useState(Array(15).fill(false));\r\n  const [prompt, setPrompt] = useState(\"\");\r\n  const [isListening, setIsListening] = useState(false);\r\n  const [volume, setVolume] = useState(50); // Volume state\r\n\r\n  // Check if the browser supports speech recognition\r\n  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\r\n  const recognition = SpeechRecognition ? new SpeechRecognition() : null;\r\n  // const [transcript, setTranscript] = useState(\"\");\r\n  // const [error, setError] = useState(null);\r\n\r\n  const [conversationHistory, setConversationHistory] = useState([]);\r\n  const [isLoggedIn, setIsLoggedIn] = useState(false); // Assume initially logged out\r\n\r\n  const [attachedFiles, setAttachedFiles] = useState([]);  // <-- Define attachedFiles here\r\n\r\n  useEffect(() => {\r\n    const fetchConversations = async () => {\r\n      try {\r\n        const csrfToken = getCsrfToken(); // Retrieve CSRF token function\r\n        const response = await axios.get('https://199c-2601-702-0-9480-988c-b43-9c08-63d1.ngrok-free.app/api/get_conversations/', {\r\n          withCredentials: true,\r\n          headers: {\r\n            'X-CSRFToken': csrfToken,\r\n          },\r\n        });\r\n        setConversationHistory(response.data);\r\n        setIsLoggedIn(true);\r\n      } catch (error) {\r\n        console.error('Error fetching conversation history:', error);\r\n        setIsLoggedIn(false);\r\n      }\r\n    };\r\n  \r\n    fetchConversations();\r\n  }, []);\r\n\r\n\r\n  if (recognition) {\r\n    recognition.continuous = false;\r\n    recognition.interimResults = false;\r\n    recognition.lang = 'en-US';\r\n\r\n    recognition.onresult = (event) => {\r\n      const transcript = event.results[0][0].transcript;\r\n      setPrompt(transcript);  // Update the entry bar with the transcribed text\r\n      console.log(\"Transcribed Text:\", transcript);  // Log transcription to browser console\r\n    };\r\n\r\n    recognition.onerror = (event) => {\r\n      console.error(\"Speech recognition error:\", event.error);  // Error handling in console\r\n      setIsListening(false);  // Reset listening state\r\n    };\r\n\r\n    recognition.onend = () => {\r\n      console.log(\"Speech recognition ended.\");  // Log end of recognition to browser console\r\n      setIsListening(false);  // Ensure the recording state is reset\r\n    };\r\n  }\r\n\r\n  // Start listening for speech\r\n  const handleStartListening = () => {\r\n    if (recognition && !isListening) {\r\n      setPrompt(\"\");  // Clear any previous text in entry bar\r\n      setIsListening(true);\r\n      console.log(\"Starting Speech Recognition\");  // Log to browser console\r\n      recognition.start();\r\n    }\r\n  };\r\n\r\n  // Stop listening for speech\r\n  const handleStopListening = () => {\r\n    if (recognition && isListening) {\r\n      console.log(\"Stopping Speech Recognition\");  // Log to browser console\r\n      recognition.stop();\r\n      setIsListening(false);  // Reset state so user can restart recording\r\n    }\r\n  };\r\n\r\n  // const handlePromptSubmit = () => {\r\n  //   const newMessage = { text: prompt, isUser: true };\r\n  //   setMessages([...messages, newMessage]);\r\n  //   handleSendMessage(prompt);\r\n  //   setPrompt(\"\");\r\n  // };\r\n\r\n  // const openPopup = (setting) => {\r\n  //   setTTSEnabled(false);\r\n  //   setSpeechRecognitionOpen(false);\r\n  //   setLLMSelectionOpen(false);\r\n  //   setUpdateExpertsOpen(false);\r\n\r\n  //   if (setting === \"TTS\") setTTSEnabled(true);\r\n  //   if (setting === \"SpeechRecognition\") setSpeechRecognitionOpen(true);\r\n  //   if (setting === \"LLMSelection\") setLLMSelectionOpen(true);\r\n  //   if (setting === \"UpdateExperts\") setUpdateExpertsOpen(true);\r\n  // };\r\n\r\n  // Function to toggle TTS setting\r\n  const toggleTTS = () => {\r\n    setTTSEnabled(!isTTSEnabled);\r\n    console.log(\"TTS Enabled:\", !isTTSEnabled); // Log for confirmation\r\n  };\r\n\r\n  const toggleExpertPopup = () => {\r\n    setExpertPopupOpen(!isExpertPopupOpen);\r\n  };\r\n\r\n  // const updateExpertName = (index, newName) => {\r\n  //   const updatedExperts = [...experts];\r\n  //   updatedExperts[index] = newName;\r\n  //   setExperts(updatedExperts);\r\n  // };\r\n\r\n  // Function to handle expert selection in the AI Image popup\r\n  const handleExpertSelection = (expert) => {\r\n    setSelectedExperts((prevExperts) => {\r\n        const updatedExperts = prevExperts.includes(expert)\r\n            ? prevExperts.filter((e) => e !== expert)\r\n            : [...prevExperts, expert];\r\n        console.log(\"Updated selectedExperts:\", updatedExperts);  // Log after update\r\n        return updatedExperts;\r\n    });\r\n  };\r\n\r\n  const handleLLMSelection = (llm) => {\r\n    setCurrentLLM(llm);\r\n    console.log(\"Updated currentLLM:\", llm);  // Log after update\r\n  };\r\n\r\n  const handleEditExpertClick = (index) => {\r\n    setCurrentExpertEdit(index);\r\n    setNewExpertName(experts[index]);\r\n    setShowEditPopup(true);\r\n  };\r\n  \r\n  const handleSaveExpertName = () => {\r\n    const updatedExperts = [...experts];\r\n    updatedExperts[currentExpertEdit] = newExpertName;\r\n    setExperts(updatedExperts);\r\n    setShowEditPopup(false);\r\n  };\r\n\r\n  function getCsrfToken() {\r\n    const name = 'csrftoken';\r\n    const cookies = document.cookie.split(';');\r\n    for (let cookie of cookies) {\r\n      cookie = cookie.trim();\r\n      if (cookie.startsWith(name + '=')) {\r\n        return cookie.substring(name.length + 1);\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  const handleRestoreConversation = (conversationText) => {\r\n    // Assuming conversationText is newline-delimited for each message\r\n    const restoredMessages = conversationText.split('\\n').map((text, idx) => ({\r\n      text,\r\n      isUser: idx % 2 === 0, // Toggle between user and AI messages for simplicity\r\n    }));\r\n    setMessages(restoredMessages);\r\n  };\r\n  \r\n\r\n  const handleSendMessage = async (message) => {\r\n    const formData = new FormData();\r\n    formData.append(\"text\", message);\r\n    formData.append(\"selected_experts\", JSON.stringify(selectedExperts));\r\n    formData.append(\"selected_option\", currentLLM);\r\n\r\n    // Attach files if there are any\r\n    if (attachedFiles.length > 0) {\r\n        attachedFiles.forEach((file) => {\r\n            formData.append('file', file);\r\n        });\r\n    }\r\n\r\n    try {\r\n        console.log(\"Sending message to backend\");\r\n        const response = await axios.post(\r\n            'https://199c-2601-702-0-9480-988c-b43-9c08-63d1.ngrok-free.app/api/analyze_text/',\r\n            formData,\r\n            {\r\n                headers: {\r\n                    'X-CSRFToken': getCsrfToken(),\r\n                },\r\n                withCredentials: true,\r\n            }\r\n        );\r\n\r\n        console.log(\"Full response data:\", response.data);\r\n\r\n        // Check if response is an object with only text or includes images\r\n        if (typeof response.data === 'object' && response.data !== null) {\r\n            const { text, images } = response.data;\r\n\r\n            // If `images` is not present or is an empty array, treat as text-only\r\n            if (text && (!images || images.length === 0)) {\r\n              console.log(\"No Images detected, treating as text\")\r\n                setMessages((prevMessages) => [\r\n                    ...prevMessages,\r\n                    { text: text, isUser: false }\r\n                ]);\r\n                if (isTTSEnabled) speakText(text, volume / 100);\r\n            } \r\n            // If images are present, handle both text and images\r\n            else {\r\n              console.log(\"Image detected\")\r\n                if (text) {\r\n                  console.log(\"The text with image is: \", text)\r\n                    setMessages((prevMessages) => [\r\n                        ...prevMessages,\r\n                        { text: text, isUser: false }\r\n                    ]);\r\n                    if (isTTSEnabled) speakText(text, volume / 100);\r\n                }\r\n\r\n                if (Array.isArray(images) && images.length > 0) {\r\n                    images.forEach((imgUrl) => {\r\n                        setMessages((prevMessages) => [\r\n                            ...prevMessages,\r\n                            { images: [{ url: imgUrl }], isUser: false }\r\n                        ]);\r\n                    });\r\n                }\r\n            }\r\n        } else if (typeof response.data === 'string') {\r\n          console.log(\"String Only\")\r\n            // Treat response as simple text if it's a string\r\n            setMessages((prevMessages) => [\r\n                ...prevMessages,\r\n                { text: response.data, isUser: false }\r\n            ]);\r\n            if (isTTSEnabled) speakText(response.data, volume / 100);\r\n        } else {\r\n            console.warn(\"Unexpected response format received:\", response.data);\r\n        }\r\n\r\n        // Save conversation if the user is logged in\r\n        if (isLoggedIn) {\r\n            const fullConversation = messages\r\n                .map((msg) => msg.text || msg.images?.[0].url || \"\")\r\n                .join('\\n');\r\n            await axios.post(\r\n                'https://199c-2601-702-0-9480-988c-b43-9c08-63d1.ngrok-free.app/api/save_conversation/',\r\n                { conversation_text: fullConversation },\r\n                {\r\n                    headers: { 'X-CSRFToken': getCsrfToken() },\r\n                    withCredentials: true,\r\n                }\r\n            );\r\n        }\r\n    } catch (error) {\r\n        console.error('Error sending message to backend:', error);\r\n    }\r\n};\r\n\r\n  // Ensure `speakText` uses the specified volume\r\n  const speakText = (text, volumeLevel = 0.5) => {\r\n    if ('speechSynthesis' in window) {\r\n      const utterance = new SpeechSynthesisUtterance(text);\r\n      utterance.volume = volumeLevel;  // Volume adjusted here\r\n      window.speechSynthesis.speak(utterance);\r\n    } else {\r\n      console.warn(\"TTS not supported in this browser\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"my-ui-container\">\r\n      <div className=\"ai-container\">\r\n        <button className=\"ai-image\" onClick={toggleExpertPopup}>\r\n          <img src={aiImage} alt=\"AI Expert\" />\r\n        </button>\r\n      </div>\r\n\r\n      {/* AI Expert Popup with Toggle Indicator */}\r\n      {isExpertPopupOpen && (\r\n        <div className=\"expert-popup\">\r\n          <h4>Available Experts</h4>\r\n          <div className=\"expert-grid\">\r\n            {experts.map((expert, index) => (\r\n              <button\r\n                key={index}\r\n                onClick={() => handleExpertSelection(expert)}\r\n                className={`expert-button ${selectedExperts.includes(expert) ? 'selected' : ''}`}\r\n              >\r\n                {expert}\r\n              </button>\r\n            ))}\r\n          </div>\r\n          <button onClick={toggleExpertPopup} className=\"close-popup-button\">Close</button>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"console-container\">\r\n      <Console\r\n        experts={experts}\r\n        conversationHistory={conversationHistory}\r\n        handleRestoreConversation={handleRestoreConversation}\r\n        handleEditExpertClick={handleEditExpertClick}\r\n        volume={volume}\r\n        setVolume={setVolume}\r\n        handleStartListening={handleStartListening}\r\n        handleStopListening={handleStopListening}\r\n        isListening={isListening} // Control the button label and behavior\r\n        handleLLMSelection={handleLLMSelection}  // Pass handleLLMSelection to Console\r\n        currentLLM={currentLLM}\r\n        toggleTTS={toggleTTS}\r\n        isTTSEnabled={isTTSEnabled}\r\n      />\r\n      </div>\r\n\r\n      <div className=\"user-container\">\r\n        <button className=\"user-image\">\r\n          <img src={userImage} alt=\"User Icon\" />\r\n        </button>\r\n      </div>\r\n\r\n      <div className=\"conversation-container\">\r\n        <ConversationWindow messages={messages} />\r\n      </div>\r\n\r\n      <div className=\"entry-box-container\">\r\n        <InputSection\r\n          attachedFiles={attachedFiles}\r\n          setAttachedFiles={setAttachedFiles}\r\n          prompt={prompt} // Pass the transcribed prompt\r\n          setPrompt={setPrompt}\r\n          onPromptSubmit={(prompt) => {\r\n            const newMessage = { text: prompt, isUser: true };\r\n            setMessages([...messages, newMessage]);\r\n            handleSendMessage(prompt);\r\n          }}\r\n          onFileUpload={(file) => console.log('File uploaded:', file.name)}\r\n          onCopyConversation={() => navigator.clipboard.writeText(messages.map(m => m.text).join('\\n'))}\r\n        />\r\n      </div>\r\n\r\n      {/* Expert Edit Popup */}\r\n      {showEditPopup && (\r\n        <div className=\"overlay\">\r\n          <div className=\"edit-popup\">\r\n            <h4>Edit Expert</h4>\r\n            <input\r\n              type=\"text\"\r\n              value={newExpertName}\r\n              onChange={(e) => setNewExpertName(e.target.value)}\r\n            />\r\n            <button onClick={handleSaveExpertName}>Save</button>\r\n            <button onClick={() => setShowEditPopup(false)}>Cancel</button>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n// Console Component\r\nfunction Console({ \r\n  experts, \r\n  handleEditExpertClick,\r\n  conversationHistory,\r\n  handleRestoreConversation, \r\n  volume, \r\n  setVolume, \r\n  handleStartListening, \r\n  handleStopListening,\r\n  isListening ,\r\n  handleLLMSelection,\r\n  currentLLM,\r\n  toggleTTS,\r\n  isTTSEnabled\r\n}) {\r\n  const [currentView, setCurrentView] = useState(\"default\");\r\n  const options = [\"Text-To-Speech\", \"Speech Recognition\", \"LLM Selection\", \"Update Experts\", \"Conversation Select\"];\r\n  const [currentOptionIndex, setCurrentOptionIndex] = useState(0);\r\n\r\n  const handleSelectOption = () => {\r\n    setCurrentView(options[currentOptionIndex]);\r\n  };\r\n\r\n  const handleBack = () => {\r\n    setCurrentView(\"default\");\r\n  };\r\n\r\n  const handleScroll = (direction) => {\r\n    if (direction === 'up') {\r\n      setCurrentOptionIndex((prev) => (prev === 0 ? options.length - 1 : prev - 1));\r\n    } else {\r\n      setCurrentOptionIndex((prev) => (prev === options.length - 1 ? 0 : prev + 1));\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"console-container\">\r\n  {currentView === \"default\" ? (\r\n    <div className=\"settings-grid\">\r\n      <div className=\"settings-display\">\r\n        <div className=\"console-option\">\r\n          {options[currentOptionIndex]}\r\n        </div>\r\n      </div>\r\n      <div className=\"settings-buttons\">\r\n        <button onClick={() => handleScroll('up')} className=\"up-arrow\">▲</button>\r\n        <button onClick={handleSelectOption} className=\"select-button\">Select</button>\r\n        <button onClick={() => handleScroll('down')} className=\"down-arrow\">▼</button>\r\n      </div>\r\n      {/* Volume Slider */}\r\n      <div className=\"volume-slider-container\">\r\n        <span className=\"volume-label\">Volume Level:</span>\r\n        <input\r\n          type=\"range\"\r\n          className=\"volume-slider\"\r\n          min=\"0\"\r\n          max=\"100\"\r\n          value={volume}\r\n          onChange={(e) => setVolume(Number(e.target.value))}\r\n        />\r\n        <span className=\"volume-level\">{volume}</span>\r\n      </div>\r\n    </div>\r\n      ) : (\r\n        <div className=\"settings-content\">\r\n          <h3>{currentView}</h3>\r\n          <div className=\"settings-page-content\">\r\n            {currentView === \"Text-To-Speech\" && (\r\n              <>\r\n                <p>Enable or disable Text-to-Speech:</p>\r\n                <button onClick={toggleTTS} className={`tts-button ${isTTSEnabled ? 'tts-enabled' : 'tts-disabled'}`}>\r\n                  {isTTSEnabled ? \"Disable TTS\" : \"Enable TTS\"}\r\n                </button>\r\n                {/* Volume Slider for Text-To-Speech */}\r\n                <div className=\"volume-slider-container\">\r\n                  <span className=\"volume-label\">TTS Volume:</span>\r\n                  <input\r\n                    type=\"range\"\r\n                    className=\"volume-slider\"\r\n                    min=\"0\"\r\n                    max=\"100\"\r\n                    value={volume}\r\n                    onChange={(e) => setVolume(Number(e.target.value))}\r\n                  />\r\n                  <span className=\"volume-level\"> {volume}</span>\r\n                </div>\r\n              </>\r\n            )}\r\n            {currentView === \"Speech Recognition\" && (\r\n              <>\r\n                <p>Control Speech Recognition:</p>\r\n                <button onClick={isListening ? handleStopListening : handleStartListening}>\r\n                  {isListening ? \"Stop Recording\" : \"Start Recording\"}\r\n                </button>\r\n              </>\r\n            )}\r\n            {currentView === \"LLM Selection\" && (\r\n              <>\r\n                <p>Select Language Model:</p>\r\n                <select\r\n                  className=\"llm-dropdown\"\r\n                  value={currentLLM || \"\"}\r\n                  onChange={(e) => handleLLMSelection(e.target.value)}\r\n                >\r\n                  <option value=\"\" disabled>Select an LLM</option>\r\n                  <option value=\"ChatGPT\">ChatGPT</option>\r\n                  <option value=\"Google Gemini\">Google Gemini</option>\r\n                  <option value=\"Anthropic Claude\">Anthropic Claude</option>\r\n                </select>\r\n              </>\r\n            )}\r\n            {currentView === \"Update Experts\" && (\r\n              <div className=\"expert-grid\">\r\n                {experts.map((expert, index) => (\r\n                  <button key={index} className=\"expert-button\" onClick={() => handleEditExpertClick(index)}>\r\n                    {expert}\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            )}\r\n            {currentView === \"Conversation Select\" && (\r\n              <>\r\n                <p>Select a conversation to review:</p>\r\n                <div className=\"conversation-history\">\r\n                  {conversationHistory.length > 0 ? (\r\n                    conversationHistory.map((conv, index) => (\r\n                      <div\r\n                        key={index}\r\n                        className=\"conversation-item\"\r\n                        onClick={() => handleRestoreConversation(conv.conversation_text)}\r\n                      >\r\n                        {`${conv.user_id}'s Conversation ${new Date(conv.timestamp).toLocaleString()}`}\r\n                      </div>\r\n                    ))\r\n                  ) : (\r\n                    <p>No conversation history available.</p>\r\n                  )}\r\n                </div>\r\n              </>\r\n            )}\r\n          </div>\r\n          <button onClick={handleBack} className=\"back-button\">Back</button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n// ConversationWindow Component\r\nfunction ConversationWindow({ messages }) {\r\n  const conversationRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    if (conversationRef.current) {\r\n      console.log(\"Updated messages:\", messages);\r\n      conversationRef.current.scrollTop = conversationRef.current.scrollHeight;\r\n    }\r\n  }, [messages]);\r\n\r\n  return (\r\n    <div className=\"conversation-window\" ref={conversationRef}>\r\n        {messages.map((message, index) => (\r\n            <div\r\n                key={index}\r\n                className={`message-bubble ${message.isUser ? 'user-message' : 'ai-message'}`}\r\n            >\r\n                {/* Display text if present */}\r\n                {message.text && <p>{message.text}</p>}\r\n                \r\n                {/* Display images if present, or skip if none */}\r\n                {message.images && message.images.length > 0 && message.images.map((img, imgIndex) => (\r\n                    <img\r\n                        key={imgIndex}\r\n                        src={img.url}\r\n                        alt=\"AI response\"\r\n                        className=\"ai-image-response\"\r\n                        style={{ maxWidth: '100%', marginTop: '10px', borderRadius: '8px' }}\r\n                    />\r\n                ))}\r\n            </div>\r\n        ))}\r\n    </div>\r\n);\r\n}\r\n\r\n// TTS function\r\n// function speakText(text) {\r\n//   if ('speechSynthesis' in window) {\r\n//     const utterance = new SpeechSynthesisUtterance(text);\r\n//     utterance.rate = 1; // You can adjust rate, pitch, and volume here if needed\r\n//     window.speechSynthesis.speak(utterance);\r\n//   } else {\r\n//     console.warn(\"TTS not supported in this browser\");\r\n//   }\r\n// }\r\n\r\n// InputSection Component\r\nfunction InputSection({ prompt, setPrompt, onPromptSubmit, onFileUpload, onCopyConversation, attachedFiles, setAttachedFiles }) {\r\n\r\n  const handleInputChange = (e) => {\r\n    setPrompt(e.target.value);\r\n    e.target.style.height = \"auto\";\r\n    e.target.style.height = `${e.target.scrollHeight}px`;\r\n  };\r\n\r\n  const handleFileUpload = (e) => {\r\n    const files = Array.from(e.target.files);\r\n  \r\n    if (attachedFiles.length + files.length > 5) {\r\n      alert(\"You can only attach up to 5 files at a time.\");\r\n      return;\r\n    }\r\n  \r\n    const newFiles = files.map((file) => {\r\n      if (file.type.startsWith(\"image/\")) {\r\n        const reader = new FileReader();\r\n        reader.onload = (e) => {\r\n          file.preview = e.target.result; // Add preview data to the file object\r\n          setAttachedFiles((prev) => [...prev]); // Trigger a re-render\r\n        };\r\n        reader.readAsDataURL(file);\r\n      }\r\n      return file;\r\n    });\r\n\r\n    setAttachedFiles((prev) => [...prev, ...newFiles]);\r\n    files.forEach((file) => onFileUpload(file));\r\n  };\r\n\r\n  const handleRemoveFile = (index) => {\r\n    const updatedFiles = attachedFiles.filter((_, i) => i !== index);\r\n    setAttachedFiles(updatedFiles);\r\n  };\r\n\r\n  const handleBlur = (e) => {\r\n    if (prompt === \"\") {\r\n      e.target.style.height = \"20px\";\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"input-section\">\r\n      {/* Display file popups above the entry bar */}\r\n      <div className=\"attached-files-container\">\r\n        {attachedFiles.map((file, index) => (\r\n          <div key={index} className=\"attached-file-popup\">\r\n            {file.preview ? (\r\n              <img src={file.preview} alt={file.name} className=\"attached-file-image\" />\r\n            ) : (\r\n              <span>{file.name}</span>\r\n            )}\r\n            <button onClick={() => handleRemoveFile(index)} className=\"remove-file-button\">✕</button>\r\n          </div>\r\n        ))}\r\n      </div>\r\n      \r\n      <textarea\r\n        value={prompt}\r\n        onChange={(e) => setPrompt(e.target.value)}\r\n        onBlur={handleBlur}\r\n        className=\"prompt-input\"\r\n        placeholder=\"Type your message here...\"\r\n        rows={1}\r\n        style={{ height: \"20px\" }}\r\n      />\r\n      <button onClick={() => onPromptSubmit(prompt)}>Submit</button>\r\n      <button onClick={onCopyConversation}>Copy Conversation</button>\r\n      <button onClick={() => document.getElementById('file-upload').click()}>Upload File</button>\r\n      <input type=\"file\" id=\"file-upload\" style={{ display: 'none' }} onChange={handleFileUpload} />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default MultiChatXpertPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}